!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.KoemeiSearchResults=e(require("jQuery")):t.KoemeiSearchResults=e(t.jQuery)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1),t.exports=i(3)},function(t,e){},,function(t,e,i){function n(t){return this.options=o(this.defaults(),t),this.EMBED_KEY=this.options.key||"",this.limit=this.options.limit||5,this._validateEmbedKey()?void 0:void(this.blocked=!0)}var r=i(4),s=i(5),o=i(6),u=i(7);o(n.prototype,{defaults:function(){var t=this;return{domain:"https://koemei.com",searchAPI:"/api/search/files",prefetchAPI:"/api/files",width:"500px",prefetch:!0,showTranscript:!0,target:"self",openOnSelect:!1,limit:5,mode:"onType",minLength:1,templates:{searching:"Searching ...",noResults:"No results found. Try another query.",suggestion:function(e){return t._getSuggestionTemplate(e)}},css:"http://iplusstd.com/koemei/search-results-plugin/dist/style.min.css",fontcss:"https://koemei.com/css/font.css",highlightColor:""}},_validateEmbedKey:function(){return this.EMBED_KEY&&""!==this.EMBED_KEY?!0:(s.logError("Koemei's Embed Key is required"),!1)},_addCSS:function(){this.options.css&&s.loadExternalAsset(this.options.css,"css"),this.options.fontcss&&s.loadExternalAsset(this.options.fontcss,"css"),this._buildCustomStyle()},_buildCustomStyle:function(){var t="";this.options.highlightColor&&(t+=".koemei-highlight,.k-results .k-suggestion .koemei-highlight,.k-results .k-suggestion .MediaListItem-segments li a:hover,.k-results .k-suggestion.openOnSelect:hover .title-item,.k-results .k-suggestion .wrapper-info:hover .title-item,.koemei-cursor .wrapper-info .title-item,.k-results .k-suggestion.openOnSelect:hover .date-item,.k-results .k-suggestion .wrapper-info:hover .date-item,.koemei-cursor .wrapper-info .date-item{color:"+this.options.highlightColor+" !important;}",t+=".k-results .k-suggestion .img-item:after { background:"+this.options.highlightColor+" !important;}"),""!==t&&(body=document.body||document.getElementsByTagName("body")[0],style=document.createElement("style"),style.type="text/css",style.styleSheet?style.styleSheet.cssText=t:style.appendChild(document.createTextNode(t)),body.appendChild(style))},_linkElements:function(t,e){if(!t)return s.logError("first parameter must be an input field.");if(!e)return s.logError("second parameter must be a dom element.");this.input=new r(t,this.options),this.linkedEl=e,this.linkedEl.innerHTML="";var i=document.createElement("div");i.className="k-results",this.linkedEl.appendChild(i),this.resultsDom=i},_setWidth:function(){this.options.width&&(this.linkedEl.style.width=this.options.width)},_initialize:function(t,e){this.blocked||(this._linkElements(t,e),this._addCSS(),this.clear(),this._setWidth(),this._initEngine(),this._resetSuggestionElement(),this._start())},_start:function(){var t=this;t.input&&(this.input.el.addEventListener("queryChanged",function(e){t.update(e.detail)}),this.input.el.addEventListener("queryReset",function(e){t.clear()}),this.input.initialize())},_initEngine:function(){var t=this,e=t.EMBED_KEY,i={initialize:!1,datumTokenizer:function(t){return u.tokenizers.whitespace(t._id)},queryTokenizer:u.tokenizers.whitespace,remote:{url:t.options.domain+t.options.searchAPI,dataType:"jsonp",transform:function(t){return t.results},replace:function(t,i){return t+"?token="+e+"&transcripts=true&q="+i}},identify:function(t){return t._id}};t.options.prefetch&&(i.prefetch={url:t.options.domain+t.options.prefetchAPI+"?token="+e,dataType:"jsonp"}),t.engine=new u(i),t.engine.initialize().fail(function(){s.utils.logError("[Bloodhound error]")})},_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.options.templates.searching?this._renderSearching(t):this._empty()},_append:function(t,e){e=e||[],e.length&&this.suggestionEl?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.suggestionEl&&this.options.templates.noResults&&this._renderNoResults(t)},_renderSuggestions:function(t,e){var i=document.createElement("div");i.className="k-suggestions",i.innerHTML="",this.resultsDom.innerHTML="",this.resultsDom.appendChild(i),this.resultsDom.appendChild(this._getFooter(t,e)),this.suggestionEl=i,this._appendSuggestions(t,e)},_appendSuggestions:function(t,e){for(var i=this,n=0;n<e.length;n++)i.suggestionEl.appendChild(i._getSuggestionElement(e[n]))},_resetSuggestionElement:function(){this.suggestionEl=null,delete this.suggestionEl},_renderSearching:function(t){this._resetSuggestionElement(),this.resultsDom.innerHTML='<div class="k-searching">'+this.options.templates.searching+"</div>"},_renderNoResults:function(t){this._resetSuggestionElement(),this.resultsDom.innerHTML='<div class="k-no-results">'+this.options.templates.noResults+"</div>"},_empty:function(){this._resetSuggestionElement(),this.resultsDom.innerHTML=""},_getFooter:function(t,e){var i=document.createElement("div");return i.className="k-results-footer",i.innerHTML='powered by <a href="//koemei.com" target="_blank"><img src="https://koemei.com/img/logo.svg" alt="koemei" /></a>',i},_getSuggestionElement:function(t){var e=document.createElement("div");return e.className="k-suggestion",e.innerHTML=this.options.templates.suggestion(t),e},_getSuggestionTemplate:function(t){var e=this,i=t.pictureUrl||"http://d3m8q0cwynqlq3.cloudfront.net/images/koemei-media-thumb.jpg",n=t.created.substring(0,10),r="",o=s.toHHMMSS(t.length),u=e.options.openOnSelect?"openOnSelect":"",r='<div class="'+u+'"><div class="wrapper-item"><div class="wrapper-info"><a class="img-item koemei-pullLeft" href="'+t.srcUrl+'"><div class="gradient"></div><img src="'+i+'" alt=""><div class="time-item">'+o+'</div></a><a href="'+t.srcUrl+'"><div class="wrapper-title"><div class="title-item">'+t.name+'</div><div class="date-item">'+n+"</div></div></a> </div></div>";if(e.options.showTranscript&&t.matchingTranscripts&&t.matchingTranscripts.list){r+='<ul class="MediaListItem-segments active">';for(var a,c,l=0;2>l&&l<t.matchingTranscripts.list.length;l++)a=t.matchingTranscripts.list[l],c=a.start/100,r+='<li><a href="'+s.addParameter(t.srcUrl,"time",c)+'"><div class="koemei-highlight koemei-time">'+s.toHHMMSS(c)+'</div> <div class="MediaListItem-segment">'+a.highlight+"</div></a></li>";r+="</ul>"}return r+="</div>"},initialize:function(t,e){return this._initialize(t,e)},update:function(t){function e(e){o||(o=!0,e=(e||[]).slice(0,n.limit),u=e.length,n._overwrite(t,e))}function i(e){e=e||[],!r&&u<n.limit&&(n.cancel=s.noop,u+=e.length,n._append(t,e.slice(0,n.limit-u)))}var n=this,r=!1,o=!1,u=0;this.cancel(),this.cancel=function(){r=!0,n.cancel=s.noop},n.engine.search(t,e,i),!o&&e([])},cancel:s.noop,clear:function(){this._empty(),this.cancel()}}),t.exports=n},function(t,e,i){function n(t,e){this.el=t,this.options=e}var r=i(5),s=i(6);s(n.prototype,{_initialize:function(){this.query="",this.bind(),this._onInput()},_onInput:function(){this._setQuery(this.getInputValue())},_setQuery:function(t,e){var i,n;i=r.areQueriesEquivalent(t,this.query),n=i?this.query.length!==t.length:!1,this.query=t,i||""!==this.query||this.emit("queryReset"),t.length<this.options.minLength||(i?n&&this.emit("whitespaceChanged",this.query):this.emit("queryChanged",this.query))},initialize:function(){this._initialize()},getInputValue:function(){return this.el.value},setInputValue:function(t){this.el.value=t},resetInputValue:function(){this.setInputValue(this.query)},emit:function(t,e){var i=new CustomEvent(t,{detail:e});this.el.dispatchEvent(i)},bind:function(){var t=this;t.el.onkeyup=function(e){e||(e=window.event);var i=e.keyCode||e.which;"onType"===t.options.mode?t._onInput():"13"===i&&t._onInput()}}}),t.exports=n},function(t,e){function i(t){return t.replace(/^\s*/g,"").replace(/\s{2,}/g," ")}e.areQueriesEquivalent=function(t,e){return i(t)===i(e)},e.logError=function(t){window.console&&window.console.error(t)},e.toHHMMSS=function(t){var e=parseInt(t,10),i=Math.floor(e/3600),n=Math.floor((e-3600*i)/60),r=e-3600*i-60*n;10>i&&(i="0"+i),10>n&&(n="0"+n),10>r&&(r="0"+r),i=i>0?i+":":"";var s=i+n+":"+r;return s},e.loadExternalAsset=function(t,e){if("js"==e){var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",t)}else if("css"==e){var i=document.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t)}"undefined"!=typeof i&&document.getElementsByTagName("head")[0].appendChild(i)},e.noop=function(){},e.addParameter=function(t,e,i){if(!t)return"";if(!i||!e)return t;var n,r=!0;if(t.indexOf("#")>0){var s=t.indexOf("#");n=t.substring(t.indexOf("#"),t.length)}else n="",s=t.length;var o=t.substring(0,s),u=o.split("?"),a="";if(u.length>1)for(var c=u[1].split("&"),l=0;l<c.length;l++){var h=c[l].split("=");r&&h[0]==e||(""==a?a="?":a+="&",a+=h[0]+"="+(h[1]?h[1]:""))}return""==a&&(a="?"),""!==a&&"?"!=a&&(a+="&"),a+=e+"="+(i?i:""),u[0]+a+n}},function(t,e){"use strict";function i(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function n(t){var e=Object.getOwnPropertyNames(t);return Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(t))),e.filter(function(e){return r.call(t,e)})}var r=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(t,e){for(var r,s,o=i(t),u=1;u<arguments.length;u++){r=arguments[u],s=n(Object(r));for(var a=0;a<s.length;a++)o[s[a]]=r[s[a]]}return o}},function(t,e,i){var n,r;/*!
	 * typeahead.js 0.11.1
	 * https://github.com/twitter/typeahead.js
	 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
	 */
!function(s,o){n=[i(8)],r=function(t){return s.Bloodhound=o(t)}.apply(e,n),!(void 0!==r&&(t.exports=r))}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,i){function n(t,e){return i(e,t)}t.each(e,n)},map:t.map,filter:t.grep,every:function(e,i){var n=!0;return e?(t.each(e,function(t,r){return(n=i.call(null,r,t,e))?void 0:!1}),!!n):n},some:function(e,i){var n=!1;return e?(t.each(e,function(t,r){return(n=i.call(null,r,t,e))?!1:void 0}),!!n):n},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function i(){return String(e)}return t.isFunction(e)?e:i},defer:function(t){setTimeout(t,0)},debounce:function(t,e,i){var n,r;return function(){var s,o,u=this,a=arguments;return s=function(){n=null,i||(r=t.apply(u,a))},o=i&&!n,clearTimeout(n),n=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var i,n,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(i,n)},function(){var a=new Date,c=e-(a-o);return i=this,n=arguments,0>=c?(clearTimeout(r),r=null,o=a,s=t.apply(i,n)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),i="0.11.1",n=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function i(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function n(t){return function(i){return i=e.isArray(i)?i:[].slice.call(arguments,0),function(n){var r=[];return e.each(i,function(i){r=r.concat(t(e.toStr(n[i])))}),r}}}return{nonword:i,whitespace:t,obj:{nonword:n(i),whitespace:n(t)}}}(),r=function(){"use strict";function i(i){this.maxSize=e.isNumber(i)?i:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function n(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(i.prototype,{set:function(t,e){var i,n=this.list.tail;this.size>=this.maxSize&&(this.list.remove(n),delete this.hash[n.key],this.size--),(i=this.hash[t])?(i.val=e,this.list.moveToFront(i)):(i=new r(t,e),this.list.add(i),this.hash[t]=i,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new n}}),e.mixin(n.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),i}(),s=function(){"use strict";function i(t,i){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=i||u,!this.ls&&this._noop()}function n(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function s(e){return t.parseJSON(e)}function o(t){var e,i,n=[],r=u.length;for(e=0;r>e;e++)(i=u.key(e)).match(t)&&n.push(i.replace(t,""));return n}var u;try{u=window.localStorage,u.setItem("~~~","!"),u.removeItem("~~~")}catch(a){u=null}return e.mixin(i.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(i){"QuotaExceededError"===i.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),s(this.ls.getItem(this._prefix(t)))},set:function(t,i,s){return e.isNumber(s)?this._safeSet(this._ttlKey(t),r(n()+s)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(i))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=o(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var i=s(this.ls.getItem(this._ttlKey(t)));return e.isNumber(i)&&n()>i?!0:!1}}),i}(),o=function(){"use strict";function i(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=t.cache===!1?new r(0):u}var n=0,s={},o=6,u=new r(10);return i.setMaxPendingRequests=function(t){o=t},i.resetCache=function(){u.reset()},e.mixin(i.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function i(t){e(null,t),l._cache.set(a,t)}function r(){e(!0)}function u(){n--,delete s[a],l.onDeckRequestArgs&&(l._get.apply(l,l.onDeckRequestArgs),l.onDeckRequestArgs=null)}var a,c,l=this;a=this._fingerprint(t),this.cancelled||a!==this.lastReq||((c=s[a])?c.done(i).fail(r):o>n?(n++,s[a]=this._send(t).done(i).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(i,n){var r,s;n=n||t.noop,i=e.isString(i)?{url:i}:i||{},s=this._fingerprint(i),this.cancelled=!1,this.lastReq=s,(r=this._cache.get(s))?n(null,r):this._get(i,n)},cancel:function(){this.cancelled=!0}}),i}(),u=window.SearchIndex=function(){"use strict";function i(i){i=i||{},i.datumTokenizer&&i.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=i.identify||e.stringify,this.datumTokenizer=i.datumTokenizer,this.queryTokenizer=i.queryTokenizer,this.reset()}function n(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[a]=[],t[u]={},t}function s(t){for(var e={},i=[],n=0,r=t.length;r>n;n++)e[t[n]]||(e[t[n]]=!0,i.push(t[n]));return i}function o(t,e){var i=0,n=0,r=[];t=t.sort(),e=e.sort();for(var s=t.length,o=e.length;s>i&&o>n;)t[i]<e[n]?i++:t[i]>e[n]?n++:(r.push(t[i]),i++,n++);return r}var u="c",a="i";return e.mixin(i.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var i=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var s,o;i.datums[s=i.identify(t)]=t,o=n(i.datumTokenizer(t)),e.each(o,function(t){var e,n,o;for(e=i.trie,n=t.split("");o=n.shift();)e=e[u][o]||(e[u][o]=r()),e[a].push(s)})})},get:function(t){var i=this;return e.map(t,function(t){return i.datums[t]})},search:function(t){var i,r,c=this;return i=n(this.queryTokenizer(t)),e.each(i,function(t){var e,i,n,s;if(r&&0===r.length)return!1;for(e=c.trie,i=t.split("");e&&(n=i.shift());)e=e[u][n];return e&&0===i.length?(s=e[a].slice(0),void(r=r?o(r,s):s)):(r=[],!1)}),r?e.map(s(r),function(t){return c.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),i}(),a=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new s(t.cacheKey)}var i;return i={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(i.data,t,this.ttl),this.storage.set(i.protocol,location.protocol,this.ttl),this.storage.set(i.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(i.data),e.protocol=this.storage.get(i.protocol),e.thumbprint=this.storage.get(i.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function i(e){t(null,r.transform(e))}var n,r=this;t&&(n=this.prepare(this._settings()),this.transport(n).fail(e).done(i))},clear:function(){return this.storage.clear(),this}}),t}(),c=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new o({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function i(t,i){e(t?[]:r.transform(i))}var n,r=this;if(e)return t=t||"",n=this.prepare(t,this._settings()),this.transport.get(n,i)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),l=function(){"use strict";function n(n){var r;return n?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(r,n),!n.url&&t.error("prefetch requires url to be set"),n.transform=n.filter||n.transform,n.cacheKey=n.cacheKey||n.url,n.thumbprint=i+n.thumbprint,n.transport=n.transport?u(n.transport):t.ajax,n):null}function r(i){var n;if(i)return n={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(n,i),!i.url&&t.error("remote requires url to be set"),i.transform=i.filter||i.transform,i.prepare=s(i),i.limiter=o(i),i.transport=i.transport?u(i.transport):t.ajax,delete i.replace,delete i.wildcard,delete i.rateLimitBy,delete i.rateLimitWait,i}function s(t){function e(t,e){return e.url=s(e.url,t),e}function i(t,e){return e.url=e.url.replace(o,encodeURIComponent(t)),e}function n(t,e){return e}var r,s,o;return r=t.prepare,s=t.replace,o=t.wildcard,r?r:r=s?e:t.wildcard?i:n}function o(t){function i(t){return function(i){return e.debounce(i,t)}}function n(t){return function(i){return e.throttle(i,t)}}var r,s,o;return r=t.limiter,s=t.rateLimitBy,o=t.rateLimitWait,r||(r=/^throttle$/i.test(s)?n(o):i(o)),r}function u(i){return function(n){function r(t){e.defer(function(){o.resolve(t)})}function s(t){e.defer(function(){o.reject(t)})}var o=t.Deferred();return i(n,r,s),o}}return function(i){var s,o;return s={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},i=e.mixin(s,i||{}),!i.datumTokenizer&&t.error("datumTokenizer is required"),!i.queryTokenizer&&t.error("queryTokenizer is required"),o=i.sorter,i.sorter=o?function(t){return t.sort(o)}:e.identity,i.local=e.isFunction(i.local)?i.local():i.local,i.prefetch=n(i.prefetch),i.remote=r(i.remote),i}}(),h=function(){"use strict";function i(t){t=l(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new c(t.remote):null,this.prefetch=t.prefetch?new a(t.prefetch):null,this.index=new u({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),t.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,i.noConflict=function(){return window&&(window.Bloodhound=r),i},i.tokenizers=n,e.mixin(i.prototype,{__ttAdapter:function(){function t(t,e,n){return i.search(t,e,n)}function e(t,e){return i.search(t,e)}var i=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){return t?i.reject():(r.add(e),r.prefetch.store(r.index.serialize()),void i.resolve())}var i,n,r=this;return i=t.Deferred(),this.prefetch?(n=this.prefetch.fromCache())?(this.index.bootstrap(n),i.resolve()):this.prefetch.fromNetwork(e):i.resolve(),i.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,i,n){function r(t){var i=[];e.each(t,function(t){!e.some(s,function(e){return o.identify(t)===o.identify(e)})&&i.push(t)}),n&&n(i)}var s,o=this;return s=this.sorter(this.index.search(t)),i(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return o.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),i}();return h})},function(e,i){e.exports=t}])});