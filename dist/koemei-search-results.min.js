!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.KoemeiSearchResults=e(require("jQuery")):t.KoemeiSearchResults=e(t.jQuery)}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){n(1),t.exports=n(3)},function(t,e){},,function(t,e,n){function i(t){var e=this;return e.options=o(e.defaults(),t),e.EMBED_KEY=e.options.key||"",e.limit=e.options.limit||5,e._validateEmbedKey()?void 0:void(e.blocked=!0)}var r=n(4),s=n(5),o=n(6),u=n(7);o(i.prototype,{defaults:function(){var t=this;return{domain:"https://koemei.com",searchAPI:"/api/search/files",prefetchAPI:"/api/files",width:"500px",prefetch:!0,showTranscript:!0,target:"_self",onSelectFn:function(e,n){return t._defaultOnSelectFn(e,n)},openOnSelect:!1,limit:5,mode:"onType",minLength:1,templates:{searching:"Searching ...",noResults:"No results found. Try another query.",suggestion:function(e){return t._getSuggestionTemplate(e)}},css:"http://iplusstd.com/koemei/search-results-plugin/dist/style.min.css",fontcss:"https://koemei.com/css/font.css",highlightColor:""}},_validateEmbedKey:function(){return this.EMBED_KEY&&""!==this.EMBED_KEY?!0:(s.logError("Koemei's Embed Key is required"),!1)},_addCSS:function(){this.options.css&&s.loadExternalAsset(this.options.css,"css"),this.options.fontcss&&s.loadExternalAsset(this.options.fontcss,"css"),this._buildCustomStyle()},_buildCustomStyle:function(){var t="";this.options.highlightColor&&(t+=".koemei-highlight,.k-results .k-suggestion .koemei-highlight,.k-results .k-suggestion .MediaListItem-segments li a:hover,.k-results .k-suggestion.openOnSelect:hover .title-item,.k-results .k-suggestion .wrapper-info:hover .title-item,.koemei-cursor .wrapper-info .title-item,.k-results .k-suggestion.openOnSelect:hover .date-item,.k-results .k-suggestion .wrapper-info:hover .date-item,.koemei-cursor .wrapper-info .date-item{color:"+this.options.highlightColor+" !important;}",t+=".k-results .k-suggestion .img-item:after { background:"+this.options.highlightColor+" !important;}"),""!==t&&(body=document.body||document.getElementsByTagName("body")[0],style=document.createElement("style"),style.type="text/css",style.styleSheet?style.styleSheet.cssText=t:style.appendChild(document.createTextNode(t)),body.appendChild(style))},_linkElements:function(t,e){if(!t)return s.logError("first parameter must be an input field.");if(!e)return s.logError("second parameter must be a dom element.");this.input=new r(t,this.options),this.linkedEl=e,this.linkedEl.innerHTML="";var n=document.createElement("div");n.className="k-results",this.linkedEl.appendChild(n),this.resultsDom=n},_setWidth:function(){this.options.width&&(this.linkedEl.style.width=this.options.width)},_initialize:function(t,e){this.blocked||(this._linkElements(t,e),this._addCSS(),this.clear(),this._setWidth(),this._initEngine(),this._resetSuggestionElement(),this._start())},_start:function(){var t=this;t.input&&(this.input.el.addEventListener("queryChanged",function(e){t.update(e.detail)}),this.input.el.addEventListener("queryReset",function(e){t.clear()}),this.input.initialize())},_initEngine:function(){var t=this,e=t.EMBED_KEY,n={initialize:!1,datumTokenizer:function(t){return u.tokenizers.whitespace(t._id)},queryTokenizer:u.tokenizers.whitespace,remote:{url:t.options.domain+t.options.searchAPI,dataType:"jsonp",transform:function(t){return t.results},replace:function(t,n){return t+"?token="+e+"&transcripts=true&q="+n}},identify:function(t){return t._id}};t.options.prefetch&&(n.prefetch={url:t.options.domain+t.options.prefetchAPI+"?token="+e,dataType:"jsonp"}),t.engine=new u(n),t.engine.initialize().fail(function(){s.utils.logError("[Bloodhound error]")})},_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.options.templates.searching?this._renderSearching(t):this._empty()},_append:function(t,e){e=e||[],e.length&&this.suggestionEl?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.suggestionEl&&this.options.templates.noResults&&this._renderNoResults(t)},_renderSuggestions:function(t,e){var n=document.createElement("div");n.className="k-suggestions",n.innerHTML="",this.resultsDom.innerHTML="",this.resultsDom.appendChild(n),this.resultsDom.appendChild(this._getFooter(t,e)),this.suggestionEl=n,this._appendSuggestions(t,e)},_appendSuggestions:function(t,e){for(var n=this,i=0;i<e.length;i++)n.suggestionEl.appendChild(n._getSuggestionElement(e[i]))},_resetSuggestionElement:function(){this.suggestionEl=null,delete this.suggestionEl},_renderSearching:function(t){this._resetSuggestionElement(),this.resultsDom.innerHTML='<div class="k-searching">'+this.options.templates.searching+"</div>"},_renderNoResults:function(t){this._resetSuggestionElement(),this.resultsDom.innerHTML='<div class="k-no-results">'+this.options.templates.noResults+"</div>"},_empty:function(){this._resetSuggestionElement(),this.resultsDom.innerHTML=""},_getFooter:function(t,e){var n=document.createElement("div");return n.className="k-results-footer",n.innerHTML='powered by <a href="//koemei.com" target="_blank"><img src="https://koemei.com/img/logo.svg" alt="koemei" /></a>',n},_getSuggestionElement:function(t){var e=document.createElement("div");return e.className="k-suggestion",e.appendChild(this.options.templates.suggestion(t)),e},_getSuggestionTemplate:function(t){var e=this,n=document.createElement("div");e.options.openOnSelect&&(n.className="openOnSelect",n.onclick=function(){e.options.onSelectFn(t)});var i=document.createElement("div");i.className="wrapper-item";var r=document.createElement("div");r.className="wrapper-info",i.appendChild(r),n.appendChild(i);var o=document.createElement("a");o.className="img-item koemei-pullLeft",o.onclick=function(){e.options.onSelectFn(t)};var u=document.createElement("div");u.className="gradient";var a=document.createElement("img");a.src=t.pictureUrl||"http://d3m8q0cwynqlq3.cloudfront.net/images/koemei-media-thumb.jpg";var c=document.createElement("div");c.className="time-item",c.innerHTML=s.toHHMMSS(t.length),o.appendChild(u),o.appendChild(a),o.appendChild(c),r.appendChild(o);var l=document.createElement("a");l.onclick=function(){e.options.onSelectFn(t)};var h=document.createElement("div");h.className="wapper-title";var p=document.createElement("div");p.className="title-item",p.innerHTML=t.name;var f=document.createElement("div");if(f.className="date-item",f.innerHTML=t.created.substring(0,10),h.appendChild(p),h.appendChild(f),l.appendChild(h),r.appendChild(l),e.options.showTranscript&&t.matchingTranscripts&&t.matchingTranscripts.list){var d=document.createElement("ul");d.className="MediaListItem-segments active",n.appendChild(d);for(var m,g,v=0;2>v&&v<t.matchingTranscripts.list.length;v++){m=t.matchingTranscripts.list[v],g=m.start/100;var y=document.createElement("li"),_=document.createElement("a");_.onclick=function(){e.options.onSelectFn(t,g)};var k=document.createElement("div");k.className="koemei-highlight koemei-time",k.innerHTML=s.toHHMMSS(g);var E=document.createElement("div");E.className="MediaListItem-segment",E.innerHTML=m.highlight,_.appendChild(k),_.appendChild(E),y.appendChild(_),d.appendChild(y)}}return n},_defaultOnSelectFn:function(t,e){var n=e?this.addParamtoLink(t.srcUrl,"time",e):t.srcUrl;window.open(n,this.options.target)},addParamtoLink:function(t,e,n){return s.addParameter(t,e,n)},initialize:function(t,e){return this._initialize(t,e)},update:function(t){function e(e){o||(o=!0,e=(e||[]).slice(0,i.limit),u=e.length,i._overwrite(t,e))}function n(e){e=e||[],!r&&u<i.limit&&(i.cancel=s.noop,u+=e.length,i._append(t,e.slice(0,i.limit-u)))}var i=this,r=!1,o=!1,u=0;this.cancel(),this.cancel=function(){r=!0,i.cancel=s.noop},i.engine.search(t,e,n),!o&&e([])},cancel:s.noop,clear:function(){this._empty(),this.cancel()}}),t.exports=i},function(t,e,n){function i(t,e){this.el=t,this.options=e}var r=n(5),s=n(6);s(i.prototype,{_initialize:function(){this.query="",this.bind(),this._onInput()},_onInput:function(){this._setQuery(this.getInputValue())},_setQuery:function(t,e){var n,i;n=r.areQueriesEquivalent(t,this.query),i=n?this.query.length!==t.length:!1,this.query=t,n||""!==this.query||this.emit("queryReset"),t.length<this.options.minLength||(n?i&&this.emit("whitespaceChanged",this.query):this.emit("queryChanged",this.query))},initialize:function(){this._initialize()},getInputValue:function(){return this.el.value},setInputValue:function(t){this.el.value=t},resetInputValue:function(){this.setInputValue(this.query)},emit:function(t,e){var n=new CustomEvent(t,{detail:e});this.el.dispatchEvent(n)},bind:function(){var t=this;t.el.onkeyup=function(e){e||(e=window.event);var n=e.keyCode||e.which;"onType"===t.options.mode?t._onInput():"13"===n&&t._onInput()}}}),t.exports=i},function(t,e){function n(t){return t.replace(/^\s*/g,"").replace(/\s{2,}/g," ")}e.areQueriesEquivalent=function(t,e){return n(t)===n(e)},e.logError=function(t){window.console&&window.console.error(t)},e.toHHMMSS=function(t){var e=parseInt(t,10),n=Math.floor(e/3600),i=Math.floor((e-3600*n)/60),r=e-3600*n-60*i;10>n&&(n="0"+n),10>i&&(i="0"+i),10>r&&(r="0"+r),n=n>0?n+":":"";var s=n+i+":"+r;return s},e.loadExternalAsset=function(t,e){if("js"==e){var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",t)}else if("css"==e){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",t)}"undefined"!=typeof n&&document.getElementsByTagName("head")[0].appendChild(n)},e.noop=function(){},e.addParameter=function(t,e,n){if(!t)return"";if(!n||!e)return t;var i,r=!0;if(t.indexOf("#")>0){var s=t.indexOf("#");i=t.substring(t.indexOf("#"),t.length)}else i="",s=t.length;var o=t.substring(0,s),u=o.split("?"),a="";if(u.length>1)for(var c=u[1].split("&"),l=0;l<c.length;l++){var h=c[l].split("=");r&&h[0]==e||(""==a?a="?":a+="&",a+=h[0]+"="+(h[1]?h[1]:""))}return""==a&&(a="?"),""!==a&&"?"!=a&&(a+="&"),a+=e+"="+(n?n:""),u[0]+a+i}},function(t,e){"use strict";function n(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function i(t){var e=Object.getOwnPropertyNames(t);return Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(t))),e.filter(function(e){return r.call(t,e)})}var r=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(t,e){for(var r,s,o=n(t),u=1;u<arguments.length;u++){r=arguments[u],s=i(Object(r));for(var a=0;a<s.length;a++)o[s[a]]=r[s[a]]}return o}},function(t,e,n){var i,r;/*!
	 * typeahead.js 0.11.1
	 * https://github.com/twitter/typeahead.js
	 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
	 */
!function(s,o){i=[n(8)],r=function(t){return s.Bloodhound=o(t)}.apply(e,i),!(void 0!==r&&(t.exports=r))}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),s=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||u,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function s(e){return t.parseJSON(e)}function o(t){var e,n,i=[],r=u.length;for(e=0;r>e;e++)(n=u.key(e)).match(t)&&i.push(n.replace(t,""));return i}var u;try{u=window.localStorage,u.setItem("~~~","!"),u.removeItem("~~~")}catch(a){u=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(n){"QuotaExceededError"===n.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),s(this.ls.getItem(this._prefix(t)))},set:function(t,n,s){return e.isNumber(s)?this._safeSet(this._ttlKey(t),r(i()+s)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=o(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=s(this.ls.getItem(this._ttlKey(t)));return e.isNumber(n)&&i()>n?!0:!1}}),n}(),o=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=t.cache===!1?new r(0):u}var i=0,s={},o=6,u=new r(10);return n.setMaxPendingRequests=function(t){o=t},n.resetCache=function(){u.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),l._cache.set(a,t)}function r(){e(!0)}function u(){i--,delete s[a],l.onDeckRequestArgs&&(l._get.apply(l,l.onDeckRequestArgs),l.onDeckRequestArgs=null)}var a,c,l=this;a=this._fingerprint(t),this.cancelled||a!==this.lastReq||((c=s[a])?c.done(n).fail(r):o>i?(i++,s[a]=this._send(t).done(n).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,s;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},s=this._fingerprint(n),this.cancelled=!1,this.lastReq=s,(r=this._cache.get(s))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),u=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[a]=[],t[u]={},t}function s(t){for(var e={},n=[],i=0,r=t.length;r>i;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function o(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var s=t.length,o=e.length;s>n&&o>i;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var u="c",a="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var s,o;n.datums[s=n.identify(t)]=t,o=i(n.datumTokenizer(t)),e.each(o,function(t){var e,i,o;for(e=n.trie,i=t.split("");o=i.shift();)e=e[u][o]||(e[u][o]=r()),e[a].push(s)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,c=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,s;if(r&&0===r.length)return!1;for(e=c.trie,n=t.split("");e&&(i=n.shift());)e=e[u][i];return e&&0===n.length?(s=e[a].slice(0),void(r=r?o(r,s):s)):(r=[],!1)}),r?e.map(s(r),function(t){return c.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),a=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new s(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),c=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new o({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),l=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?u(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=s(n),n.limiter=o(n),n.transport=n.transport?u(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function s(t){function e(t,e){return e.url=s(e.url,t),e}function n(t,e){return e.url=e.url.replace(o,encodeURIComponent(t)),e}function i(t,e){return e}var r,s,o;return r=t.prepare,s=t.replace,o=t.wildcard,r?r:r=s?e:t.wildcard?n:i}function o(t){function n(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var r,s,o;return r=t.limiter,s=t.rateLimitBy,o=t.rateLimitWait,r||(r=/^throttle$/i.test(s)?i(o):n(o)),r}function u(n){return function(i){function r(t){e.defer(function(){o.resolve(t)})}function s(t){e.defer(function(){o.reject(t)})}var o=t.Deferred();return n(i,r,s),o}}return function(n){var s,o;return s={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(s,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),o=n.sorter,n.sorter=o?function(t){return t.sort(o)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}(),h=function(){"use strict";function n(t){t=l(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new c(t.remote):null,this.prefetch=t.prefetch?new a(t.prefetch):null,this.index=new u({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),t.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){return t?n.reject():(r.add(e),r.prefetch.store(r.index.serialize()),void n.resolve())}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(s,function(e){return o.identify(t)===o.identify(e)})&&n.push(t)}),i&&i(n)}var s,o=this;return s=this.sorter(this.index.search(t)),n(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return o.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return h})},function(e,n){e.exports=t}])});